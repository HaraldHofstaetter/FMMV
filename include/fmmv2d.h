/* This file is automatically generated by gen_frontend.py */
/* DO NOT EDIT! */

#ifndef _FMMV_2D_H_
#define _FMMV_2D_H_

#define STAT_MAX 20
#define MAX_NUM_PAPI_EVENTS 10

enum StatStep {
        STAT_TOTAL,
        STAT_BUILD_TREE, 
	STAT_GEN_M,
        STAT_M2M, 
	STAT_M2L, 
	STAT_L2L,
        STAT_EVAL_L,
        STAT_LIST1, 
	STAT_LIST3, 
	STAT_LIST4, 
	STAT_LIST34,
        STAT_FARFIELD, 
	STAT_NEARFIELD,
	STAT_INITIALIZE,
	STAT_EVALUATE,
	STAT_FINALIZE,
	_STAT_LAST_ /* mark last entry, do not remove! */	
};

struct FmmvStatistics {
	double time[STAT_MAX];
	double etime[STAT_MAX];

	int PAPIeventSet;
	long long int PAPIvalues[STAT_MAX][MAX_NUM_PAPI_EVENTS];

	int pM;
	int pL;
	int s_eps;
	int s_exp;
		
	int noOfParticles;
	int noOfTargets;
	int noOfSourceLevels;
	int noOfTargetLevels;
	
	int maxNoOfStoredXin;
	int maxAllocatedMemory;
	long long int noOfDirectInteractions;

	int noOfSourceBoxes;
	int noOfTargetBoxes;
	int noOfSourceLeafBoxes;
	int noOfTargetLeafBoxes;
	float averageNoOfParticlesPerLeafBox;
	float averageNoOfTargetsPerLeafBox;

	int noOfParticlesInLevel[52];
	int noOfTargetsInLevel[52];
	int noOfSourceBoxesInLevel[52];
	int noOfTargetBoxesInLevel[52];
	int noOfSourceLeafBoxesInLevel[52];
	int noOfTargetLeafBoxesInLevel[52];
	float averageNoOfParticlesPerLeafBoxInLevel[52];
	float averageNoOfTargetsPerLeafBoxInLevel[52];
	
};

void printFmmvStatistics(struct FmmvStatistics *stat);
	
struct FmmvOptions {
	double beta; /* default: 0 */

	int pM; /* default:6 */
	int pL; /* default:6 */
	int s; 

	int ws; /* default: 1 */
	int reducedScheme;

	double scale; /* default: 1 */
	int splitThreshold;  
	int splitTargetThreshold; 
	int levels;
	int directEvalThreshold;  
	int periodicBoundaryConditions; /* default: 0 */
	int extrinsicCorrection; /* default: 0 */
	int useHilbertOrder;  	/* default: 0, i.e. use Molton order */
	int directEvalAccuracy;	/* default: 2 (double) resp. 1 (single) */
	int useFarfieldNearfieldThreads;	/* default: 0 */
	
	int PAPIeventSet;

};

struct FmmvOptions fmmvGetDefaultOptions(void);
	
void fmmv2df(
	unsigned int NParticles, 
	float particles[][2],
	float charges[],
	float dipoleMoments[][2],
	unsigned int NTargets, 
	float targets[][2],
	float potentials[],
	float gradients[][2],
	struct FmmvOptions *options, /* if NULL use default options */
	struct FmmvStatistics *statistics, /* can be NULL */
	char **errorMessage);

void fmmv2d(
	unsigned int NParticles, 
	double particles[][2],
	double charges[],
	double dipoleMoments[][2],
	unsigned int NTargets, 
	double targets[][2],
	double potentials[],
	double gradients[][2],
	struct FmmvOptions *options, /* if NULL use default options */
	struct FmmvStatistics *statistics, /* can be NULL */
	char **errorMessage);

#define DIPOLEMOMENTS 1
#define CHARGES 2

#define POTENTIALS 1
#define GRADIENTS 2

void fmmv2df_initialize(
	void** fmmvHandle,
	unsigned int NParticles,
	float particles[][2],
	int typeSources,
	unsigned int NTargets, 
	float targets[][2],
	int typeTargets,
	struct FmmvOptions *options, /* if NULL use default options */
	struct FmmvStatistics *statistics, /* can be NULL */
	char **errorMessage);

void fmmv2d_initialize(
	void** fmmvHandle,
	unsigned int NParticles,
	double particles[][2],
	int typeSources,
	unsigned int NTargets, 
	double targets[][2],
	int typeTargets,
	struct FmmvOptions *options, /* if NULL use default options */
	struct FmmvStatistics *statistics, /* can be NULL */
	char **errorMessage);

void fmmv2df_evaluate(
	void* fmmvHandle,
	float charges[],
	float dipoleMoments[][2],
	float potentials[],
	float gradients[][2],
	struct FmmvStatistics *statistics, /* can be NULL */
	char **errorMessage);

void fmmv2d_evaluate(
	void* fmmvHandle,
	double charges[],
	double dipoleMoments[][2],
	double potentials[],
	double gradients[][2],
	struct FmmvStatistics *statistics, /* can be NULL */
	char **errorMessage);

void fmmv2df_finalize(
	void* fmmvHandle,
	struct FmmvStatistics *statistics, /* can be NULL */
	char **errorMessage);

void fmmv2d_finalize(
	void* fmmvHandle,
	struct FmmvStatistics *statistics, /* can be NULL */
	char **errorMessage);


void fmmv2df_direct(
	unsigned int NParticles, 
	float particles[][2],
	float charges[],
	float dipoleMoments[][2],
	unsigned int NTargets, 
	float targets[][2],
	float potentials[],
	float gradients[][2],
	int accuracy,
	double beta,
	double *time,
	char **errorMessage);

void fmmv2d_direct(
	unsigned int NParticles, 
	double particles[][2],
	double charges[],
	double dipoleMoments[][2],
	unsigned int NTargets, 
	double targets[][2],
	double potentials[],
	double gradients[][2],
	int accuracy,
	double beta,
	double *time,
	char **errorMessage);

#endif /* _FMMV_2D_H_ */
